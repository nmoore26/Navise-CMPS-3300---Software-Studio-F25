# ===== system.properties =====
# Create this file in your project root
# Specifies Java version for deployment platforms
java.runtime.version=21

# ===== render.yaml =====
# Create this file in your project root for Render.com deployment
services:
  - type: web
    name: navise-website
    env: java
    buildCommand: ./mvnw clean package -DskipTests
    startCommand: java -Dserver.port=$PORT -jar target/*.jar
    envVars:
      - key: SPRING_PROFILES_ACTIVE
        value: production
      - key: JAVA_OPTS
        value: -Xmx512m

# ===== Procfile =====
# Create this file in your project root for Heroku deployment
web: java -Dserver.port=$PORT -jar target/*.jar

# ===== application-production.properties =====
# Create in src/main/resources/
# Production-specific configuration
server.port=${PORT:8080}
spring.datasource.url=jdbc:sqlite:studentinfo.db
logging.level.root=INFO
logging.level.com.example.navisewebsite=DEBUG

# ===== .gitignore additions =====
# Add these lines to your .gitignore
*.db
*.db-journal
target/
.mvn/
mvnw
mvnw.cmd

# ===== nginx.conf (for traditional server deployment) =====
# Example nginx configuration
server {
    listen 80;
    server_name your-domain.com www.your-domain.com;
    
    # Redirect HTTP to HTTPS
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name your-domain.com www.your-domain.com;
    
    # SSL configuration
    ssl_certificate /etc/letsencrypt/live/your-domain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/your-domain.com/privkey.pem;
    
    # Proxy to Spring Boot application
    location / {
        proxy_pass http://localhost:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
    
    # Static resources caching
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
        proxy_pass http://localhost:8080;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}

# ===== systemd service (for traditional Linux server) =====
# Save as /etc/systemd/system/navise.service
[Unit]
Description=Navise Website
After=syslog.target network.target

[Service]
User=navise
WorkingDirectory=/opt/navise
ExecStart=/usr/bin/java -jar /opt/navise/navise-website.jar
SuccessExitStatus=143
StandardOutput=journal
StandardError=journal
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target

# ===== Docker deployment =====
# Dockerfile
FROM eclipse-temurin:21-jdk-alpine AS build
WORKDIR /app
COPY . .
RUN ./mvnw clean package -DskipTests

FROM eclipse-temurin:21-jre-alpine
WORKDIR /app
COPY --from=build /app/target/*.jar app.jar
COPY studentinfo.db .
COPY courses.db .
EXPOSE 8080
ENTRYPOINT ["java", "-jar", "app.jar"]

# docker-compose.yml
version: '3.8'
services:
  navise-web:
    build: .
    ports:
      - "8080:8080"
    environment:
      - SPRING_PROFILES_ACTIVE=production
    volumes:
      - ./studentinfo.db:/app/studentinfo.db
      - ./courses.db:/app/courses.db
    restart: unless-stopped
